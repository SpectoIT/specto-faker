"use strict";var specto_faker={initiated:!1,keys_initiated:!1,config:{object_selector:".faker",open_class:"open",init_class:"faker-init",anim_class:"faker-animated",anim_progress_class:"faker-animating",focused_class:"faker-focused",key_events_class:"faker-keyevent",searchable_class:"faker-search",searchable_from_start_class:"faker-search-start",select_single:"faker-sel-single",braille_class:"faker-braille",selected_val_class:"active",disabled_val_class:"rel-disabled",search_hidden:"rel-search",nv_helper_class:"non-visual-helper",animated:!1,animation_speed:400,count_selected:!1,count_disables:!0,count_manual_val:0,key_events:!1,searchable:!0,search_single:!0,search_only_from_start:!1,sortable:!1,sort_ascending:!0,before_change:function(e,s){return e},on_change:null,on_init:null,braille_support:!1},lastClosedFaker:null,init:function(e){var s=$.extend({},specto_faker.config,e&&"object"==typeof e?e:{}),a=[];return specto_faker.initiated||(specto_faker.config.init_class=s.init_class,specto_faker.config.open_class=s.open_class,specto_faker.config.anim_class=s.anim_class,specto_faker.config.anim_progress_class=s.anim_progress_class,specto_faker.config.focused_class=s.focused_class,specto_faker.config.selected_val_class=s.selected_val_class,specto_faker.config.disabled_val_class=s.disabled_val_class,specto_faker.config.key_events_class=s.key_events_class,specto_faker.config.searchable_class=s.searchable_class,specto_faker.config.searchable_from_start_class=s.searchable_from_start_class,specto_faker.config.select_single=s.select_single,specto_faker.config.braille_class=s.braille_class,specto_faker.config.search_hidden=s.search_hidden,specto_faker.config.nv_helper_class=s.nv_helper_class,specto_faker.config.count_selected=s.count_selected,specto_faker.config.count_disables=s.count_disables,specto_faker.config.count_manual_val=s.count_manual_val),$(s.object_selector).each(function(){var e=specto_faker.getTargetelement(this),t=!1;if(a.push(e),s.sortable&&specto_faker.sortValues(e,s.sort_ascending),s.animated?$(e).addClass(specto_faker.config.anim_class):$(e).removeClass(specto_faker.config.anim_class),s.braille_support?($(e).addClass(specto_faker.config.braille_class),s.key_events=!0):$(e).removeClass(specto_faker.config.braille_class),s.key_events?$(e).addClass(specto_faker.config.key_events_class):$(e).removeClass(specto_faker.config.key_events_class),s.searchable&&s.key_events?($(e).addClass(specto_faker.config.searchable_class),s.search_single&&$(e).addClass(specto_faker.config.select_single),s.search_only_from_start&&$(e).addClass(specto_faker.config.searchable_from_start_class)):$(e).removeClass(specto_faker.config.searchable_class),$(e).addClass(specto_faker.config.init_class),$(e).find(".drop-value, .drop-handle").each(function(){$(this).off("click").click(function(){var e=specto_faker.returnFakerElementFromChild(this);specto_faker.isFakerOpen(e)?specto_faker.animateFaker(e):specto_faker.animateFaker(e,"openme")})}),specto_faker.fakerSelection(e,s.on_change,s.before_change),$(e).find(".drop-value span").text()||($(e).find(".drop-selection .drop-selection-item[selected]").length?specto_faker.updateValue($(e).find(".drop-selection .drop-selection-item[selected]").first().addClass(specto_faker.config.selected_val_class),"noclick"):specto_faker.updateValue($(e).find(".drop-selection .drop-selection-item").first(),"noclick")),$(e).find("select").each(function(){t=!0,$(this).removeClass("faker").off("focus").focus(function(){specto_faker.isFakerOpen(e)||($("."+specto_faker.config.init_class+"."+specto_faker.config.open_class).each(function(){specto_faker.animateFaker(this,!1,{dont_save_closed:!0})}),specto_faker.animateFaker(specto_faker.returnFakerElementFromChild(this),"openme"))}),s.searchable&&s.key_events||$(this).off("blur").blur(function(){specto_faker.animateFaker(specto_faker.returnFakerElementFromChild(this))})}),!t&&s.braille_support?specto_faker.hasFakerNvHelperInput(e)||($(e).prepend("<input class='"+specto_faker.config.nv_helper_class+"' name='non-visual-helper' />"),$(e).find("."+specto_faker.config.nv_helper_class).each(function(){$(this).focus(function(s){specto_faker.isFakerOpen(specto_faker.returnFakerElementFromChild(this))||($("."+specto_faker.config.init_class+"."+specto_faker.config.open_class).each(function(){specto_faker.animateFaker(this,!1,{dont_save_closed:!0})}),specto_faker.animateFaker(specto_faker.returnFakerElementFromChild(this),"openme")),specto_faker.brailleSpeach(e,"selection")})}),s.searchable&&s.key_events||$(e).off("click").click(function(){$(this).find("."+specto_faker.config.nv_helper_class).each(function(){$(this).focus()})})):$(e).find("."+specto_faker.config.nv_helper_class).each(function(){$(this).remove()}),t&&$(e).closest("form").length>0)switch(document.readyState){case"complete":$(e).closest("form")[0].reset();break;default:$(window).on("load",function(){$(e).closest("form")[0].reset()})}}),specto_faker.initiated||$(document).mouseup(function(e){$("."+specto_faker.config.init_class+"."+specto_faker.config.open_class).each(function(){$(this).is(e.target)||0!==$(this).has(e.target).length||specto_faker.animateFaker(this)})}),specto_faker.keys_initiated||(specto_faker.keys_initiated=!0,$(document).on("keyup",function(e){var s=!1;($("."+specto_faker.config.init_class+"."+specto_faker.config.key_events_class+"."+specto_faker.config.open_class).each(function(){specto_faker.keyEvents(this,e),s=!0}),s)||13===(e.keyCode||e.which)&&specto_faker.lastClosedFaker&&specto_faker.animateFaker(specto_faker.lastClosedFaker,"openme")})),specto_faker.config.animation_speed=s.animation_speed,specto_faker.initiated=!0,s.on_init&&s.on_init(a),a},fakerSelection:function(e,s,a){$(e).find(".drop-selection .drop-selection-item").each(function(){$(this).off().click(function(t){if("string"!=typeof $(this).attr("disabled")){if(a&&!a(specto_faker.getSelectionValue(this),t))return t.preventDefault(),void t.stopPropagation();$(this).siblings().filter(function(){return $(this).hasClass(specto_faker.config.selected_val_class)}).each(function(){$(this).removeClass(specto_faker.config.selected_val_class)}),specto_faker.updateValue(this);var c=this;setTimeout(function(){$(c).addClass(specto_faker.config.selected_val_class)},specto_faker.isFakerAnimated(e)?specto_faker.config.animation_speed:0),s&&s(specto_faker.getSelectionValue(this),t)}})})},updateValue:function(e,s,a){if(a=a||{},!($(e).length<1)){$(e).siblings().filter(function(){return $(this).hasClass(specto_faker.config.selected_val_class)}).each(function(){$(this).removeClass(specto_faker.config.selected_val_class)}),$(e).addClass(specto_faker.config.selected_val_class);var t=$(e).closest(".drop-selection").prevAll(".drop-value").attr("rel",$(e).attr("rel")).find("span").text($(e).text()).parent(),c=$(e).closest(".drop-selection").prevAll("select");c.length>0&&$(c).val(specto_faker.getSelectionValue(e)).change();var o=specto_faker.returnFakerElementFromChild(e);s?a.manual_close&&specto_faker.animateFaker(o,!1,{dont_remove_focus:!0}):$(t).trigger("click"),specto_faker.isFakerBrailleSupport(o)&&(specto_faker.isFakerSearchable(o)?a.focus_nv&&$(o).find("input[name='faker-search']").each(function(){$(this).val(specto_faker.getFakerUserValue(o)).attr("title",specto_faker.brailleListText(o)),this.setSelectionRange(0,200),$(this).focus()}):specto_faker.brailleSpeach(specto_faker.returnFakerElementFromChild(e),"selection"))}},getFakerValue:function(e){return $(e).find(".drop-value").attr("rel")},getFakerUserValue:function(e){return $(e).find(".drop-value span").text().trim()},getSelectionValue:function(e){return $(e).attr("rel")},isFakerOpen:function(e){return $(e).hasClass(specto_faker.config.open_class)},isFakerAnimated:function(e){return $(e).hasClass(specto_faker.config.anim_class)},isFakerSearchable:function(e){return $(e).hasClass(specto_faker.config.searchable_class)},isFakerSearchableFromStart:function(e){return $(e).hasClass(specto_faker.config.searchable_from_start_class)},isFakerBrailleSupport:function(e){return $(e).hasClass(specto_faker.config.braille_class)},hasFakerNvHelperInput:function(e){return $(e).find("."+specto_faker.config.nv_helper_class).length>0},returnFakerElementFromChild:function(e){return $(e).closest("."+specto_faker.config.init_class)},animateFaker:function(e,s,a){if(a=a||{},s?$("."+specto_faker.config.focused_class).each(function(){$(this).removeClass(specto_faker.config.focused_class)}):specto_faker.lastClosedFaker=null,specto_faker.isFakerAnimated(e)){if($(e).hasClass(specto_faker.config.anim_progress_class))return;if($(e).addClass(specto_faker.config.anim_progress_class),s){specto_faker.makeFakerSearchable(e);var t=$(e).find(".drop-selection").css({visibility:"hidden",opacity:"1"}),c="div";specto_faker.config.count_selected&&(c+=":not(."+specto_faker.config.selected_val_class+")"),specto_faker.config.count_disables&&(c+=":not(."+specto_faker.config.disabled_val_class+")");var o=parseInt(specto_faker.config.count_manual_val)>0?parseInt(specto_faker.config.count_manual_val):$(t).find(c).length;$(e).addClass(specto_faker.config.focused_class),$(t).css({height:"0px",visibility:"visible"}).animate({height:$(t).find("div").first().outerHeight()*o+"px"},{duration:specto_faker.config.animation_speed,always:function(){$(t).removeAttr("style"),$(e).addClass(specto_faker.config.open_class),$(e).removeClass(specto_faker.config.anim_progress_class)}}),specto_faker.isFakerSearchable(e)&&specto_faker.hasFakerNvHelperInput(e)&&$(e).find("."+specto_faker.config.nv_helper_class).each(function(){$(this).attr("tabindex","-1")})}else{specto_faker.removeFakerSearchable(e);t=$(e).find(".drop-selection");$(e).removeClass(specto_faker.config.open_class),$(t).css({height:$(t).height()+"px"}).animate({height:"0px"},{duration:specto_faker.config.animation_speed,always:function(){$(t).removeAttr("style"),$(e).removeClass(specto_faker.config.anim_progress_class),a.dont_remove_focus||$(e).removeClass(specto_faker.config.focused_class),a.dont_save_closed||(specto_faker.lastClosedFaker=e)}}),specto_faker.isFakerSearchable(e)&&specto_faker.hasFakerNvHelperInput(e)&&setTimeout(function(){$(e).find("."+specto_faker.config.nv_helper_class).each(function(){$(this).removeAttr("tabindex")})},20)}}else s?($(e).addClass(specto_faker.config.open_class).addClass(specto_faker.config.focused_class),specto_faker.makeFakerSearchable(e),specto_faker.isFakerSearchable(e)&&specto_faker.hasFakerNvHelperInput(e)&&$(e).find("."+specto_faker.config.nv_helper_class).each(function(){$(this).attr("tabindex","-1")})):($(e).removeClass(specto_faker.config.open_class),a.dont_remove_focus||$(e).removeClass(specto_faker.config.focused_class),specto_faker.removeFakerSearchable(e),a.dont_save_closed||(specto_faker.lastClosedFaker=e),specto_faker.isFakerSearchable(e)&&specto_faker.hasFakerNvHelperInput(e)&&setTimeout(function(){$(e).find("."+specto_faker.config.nv_helper_class).each(function(){$(this).removeAttr("tabindex")})},20))},getTargetelement:function(e){if("SELECT"===$(e).prop("tagName")){if($(e).parent().hasClass(specto_faker.config.init_class))return $(e).parent();var s=$(e).attr("placeholder"),a=$("<div class='faker'><div class='drop-value'><span></span></div><div class='drop-handle'>&nbsp;</div><div class='drop-selection'></div></div>");$(e).find("option").each(function(){var e=$(this).text(),t="string"==typeof $(this).attr("selected");t&&(s=""),$(a).find(".drop-selection").append("<div class='drop-selection-item' rel='"+($(this).attr("value")||e)+"'"+("string"==typeof $(this).attr("disabled")?" disabled='disabled' class='"+specto_faker.config.disabled_val_class+"'":"")+(t?" selected='selected'":"")+">"+e+"</div>")}),$(a).prepend($(e).clone(!0)),s&&($(a).find(".drop-value span").text(s),$(a).find(".drop-selection").prepend("<div rel='' disabled='disabled' class='drop-selection-item "+specto_faker.config.disabled_val_class+"'>"+s+"</div>"),$(a).find("option[value='']").length<1&&$(a).find("select").prepend("<option value='' selected='selected' disabled='disabled'>placeholder</option>")),$(e).after(a);var t=$(e).next();return $(e).remove(),t}return e},updateOptions:function(e,s,a,t,c){$(e).each(function(){$(this).find(".drop-value span").each(function(){$(this).text("")}),$(this).find(".drop-selection").each(function(){$(this).empty();var e="";$.each(s,function(s,c){e+="<div class='drop-selection-item' rel='"+c[a||"rel"]+"' "+(c.is_default?"selected":"")+">"+c[t||"name"]+"</div>"}),$(this).append(e)}),$(e).find("select").each(function(){$(this).empty();var e="";$.each(s,function(s,c){e+="<option value='"+c[a||"rel"]+"'>"+c[t||"name"]+"</option>"}),$(this).append(e)}),$(this).specto_faker(c)})},keyEvents:function(e,s){if(specto_faker.isFakerOpen(e)){var a=s.keyCode||s.which;switch(a){case 13:$(e).find("."+specto_faker.config.nv_helper_class).each(function(){$(this).focus()}),specto_faker.animateFaker(e,!1,{dont_remove_focus:specto_faker.hasFakerNvHelperInput(e)}),specto_faker.brailleClosedFakerButFocusedNvHelper(e);break;case 40:specto_faker.selection.next(e);break;case 38:specto_faker.selection.previous(e);break;case 9:case 16:break;default:if(specto_faker.isFakerSearchable(e))specto_faker.filterBySearchInput(e);else{var t=String.fromCharCode(a);t.search(/[a-zA-Z0-9\.\-]/)>-1&&specto_faker.selection.tochar(e,t.toLowerCase())}}}},selection:{filter_fn:function(){return!$(this).hasClass(specto_faker.config.disabled_val_class)&&!$(this).hasClass(specto_faker.config.search_hidden)},next:function(e){var s=!1;$(e).find(".drop-selection .drop-selection-item."+specto_faker.config.selected_val_class).first().each(function(){if(s=!0,$(this).nextAll().filter(specto_faker.selection.filter_fn).length>0)specto_faker.updateValue($(this).nextAll().filter(specto_faker.selection.filter_fn).first(),"noclick",{focus_nv:!0});else{var e=$(this).prevAll().filter(specto_faker.selection.filter_fn);e.length>0&&specto_faker.updateValue(e.last(),"noclick",{focus_nv:!0})}}),s||specto_faker.updateValue($(e).find(".drop-selection .drop-selection-item").filter(specto_faker.selection.filter_fn).first(),"noclick",{focus_nv:!0})},previous:function(e){var s=!1;$(e).find(".drop-selection .drop-selection-item."+specto_faker.config.selected_val_class).first().each(function(){if(s=!0,$(this).prevAll().filter(specto_faker.selection.filter_fn).length>0)specto_faker.updateValue($(this).prevAll().filter(specto_faker.selection.filter_fn).first(),"noclick",{focus_nv:!0});else{var e=$(this).nextAll().filter(specto_faker.selection.filter_fn);e.length>0&&specto_faker.updateValue(e.last(),"noclick",{focus_nv:!0})}}),s||specto_faker.updateValue($(e).find(".drop-selection .drop-selection-item").filter(specto_faker.selection.filter_fn).last(),"noclick",{focus_nv:!0})},tochar:function(e,s){var a=!1;$(e).find(".drop-selection .drop-selection-item."+specto_faker.config.selected_val_class).first().each(function(){$(this).text().slice(0,1).toLowerCase()==s&&(a=!0)}),a&&$(e).find(".drop-selection .drop-selection-item."+specto_faker.config.selected_val_class).first().each(function(){var e=$(this).nextAll().filter(function(){return $(this).text().slice(0,1).toLowerCase()==s&&!$(this).hasClass(specto_faker.config.search_hidden)});e.length<1?a=!1:specto_faker.updateValue(e.first(),"noclick",{focus_nv:!0})}),a||$(e).find(".drop-selection .drop-selection-item").filter(function(){return $(this).text().slice(0,1).toLowerCase()==s&&!$(this).hasClass(specto_faker.config.search_hidden)}).first().each(function(){specto_faker.updateValue(this,"noclick",{focus_nv:!0})})}},makeFakerSearchable:function(e){if(specto_faker.isFakerSearchable(e)){var s=$(e).parents("label").length>0?$(e).parents("label").first().attr("title"):"",a=specto_faker.isFakerBrailleSupport(e)?s+" combobox "+specto_faker.getFakerUserValue(e)+" expanded has autocomplete. This combobox can be searchable by input and by using arrow keys":"";$(e).find(".drop-value").append("<input autocomplete='both' type='text' name='faker-search' class='form-control' tabindex='-1' title='"+a+"' />"),$(e).find("input[name='faker-search']").each(function(){$(this).click(function(e){e.preventDefault(),e.stopPropagation()}),$(this).on("keydown",function(e){switch(e.keyCode||e.which){case 9:specto_faker.animateFaker(specto_faker.returnFakerElementFromChild(this),!1,{dont_save_closed:!0})}}),$(this).focus(),$(this).val(specto_faker.getFakerUserValue(e)||"")[0].setSelectionRange(0,200)})}},removeFakerSearchable:function(e){specto_faker.isFakerSearchable(e)&&($(e).find("input[name='faker-search']").each(function(){$(this).remove()}),$(e).find(".drop-selection .drop-selection-item."+specto_faker.config.search_hidden).each(function(){$(this).removeClass(specto_faker.config.search_hidden)}))},filterBySearchInput:function(e){var s=$(e).find("input[name='faker-search']").val();if(s)s=s.toLowerCase();else if("string"!=typeof s)return;var a=0,t=!1,c=specto_faker.isFakerBrailleSupport(e)||specto_faker.isFakerSearchableFromStart(e);$(e).find(".drop-selection .drop-selection-item").each(function(){var o=$(this).text().toLowerCase().search(s);if(c&&0===o||!c&&o>-1){if($(this).removeClass(specto_faker.config.search_hidden),a++,!t&&(t=!0,specto_faker.isFakerBrailleSupport(e))){var n=$(this).text();$(e).find("input[name='faker-search']").val(n)[0].setSelectionRange(s.length,n.length+1),specto_faker.updateValue(this,"noclick")}}else $(this).addClass(specto_faker.config.search_hidden)}),1===a&&$(e).hasClass(specto_faker.config.select_single)&&($(e).find("."+specto_faker.config.nv_helper_class).each(function(){$(this).focus()}),$(e).find(".drop-selection .drop-selection-item:not(."+specto_faker.config.search_hidden+")").each(function(){specto_faker.updateValue(this,"noclick",{manual_close:!0}),specto_faker.brailleClosedFakerButFocusedNvHelper(e)}))},sortValues:function(e,s){var a=[];return $(e).find(".drop-selection .drop-selection-item:not(."+specto_faker.config.disabled_val_class+")").each(function(e){a.push({rel:$(this).attr("rel"),val:$(this).text(),i:e})}),a.sort(function(e,a){return e.val.localeCompare(a.val)*(s?1:-1)}),$.each(a,function(s,a){$(e).find(".drop-selection").append($(e).find(".drop-selection .drop-selection-item:not(."+specto_faker.config.disabled_val_class+")").eq(a.i).clone().addClass("tmp"))}),$.each(a,function(s,a){$(e).find(".drop-selection .drop-selection-item:not(."+specto_faker.config.disabled_val_class+"):not(.tmp)").each(function(){$(this).remove()})}),$(e).find(".drop-selection .drop-selection-item.tmp").each(function(){$(this).removeClass("tmp")}),!0},brailleSpeach:function(e,s,a){switch(s){case"selection":var t=specto_faker.brailleListText(e);specto_faker.hasFakerNvHelperInput(e)?$(e).find("."+specto_faker.config.nv_helper_class).val(t):$(document.activeElement).attr("title",t)}},brailleListText:function(e){return specto_faker.getFakerUserValue(e)+" "+($(e).find(".drop-selection .drop-selection-item."+specto_faker.config.selected_val_class).prevAll().filter(specto_faker.selection.filter_fn).length+1)+" of "+$(e).find(".drop-selection .drop-selection-item").filter(specto_faker.selection.filter_fn).length},brailleClosedFakerButFocusedNvHelper:function(e){$(e).find("."+specto_faker.config.nv_helper_class).each(function(){$(this).attr("tabindex","-1").blur(function(){$(this).off("blur").removeAttr("tabindex"),$(specto_faker.returnFakerElementFromChild(this)).removeClass(specto_faker.config.focused_class)})})}};!function(e){e.fn.specto_faker=function(s){return specto_faker.init(e.extend(s,{object_selector:this}))}}(jQuery);